NASTAVI_VETER = function(u,N,M){ 

dim = c((N-2)*3,(M-2)*4)
X = matrix(rep(0, dim[1]*dim[2]), dim[1], dim[2])

for (i in 2:(N-1)){ 

for (j in 2:(M-1)){

B = matrix(rep(0,4*3),4,3)

B[1,1] = 1/6*(u[i-1,j-1]+u[i-1,j]+u[i,j-1])+1/2*u[i,j]
B[1,2] = 1/3*u[i-1,j]+2/3*u[i,j]
B[1,3] = 1/6*(u[i-1,j]+u[i-1,j+1]+u[i,j+1])+1/2*u[i,j]

B[2,1] = 1/4*(u[i-1,j-1]+u[i,j-1])+1/2*u[i,j]
B[2,2] = 1/10*(u[i,j-1]+u[i-1,j-1]+u[i-1,j]+u[i-1,j+1]+u[i,j+1])+1/2*u[i,j]
B[2,3] = 1/4*(u[i-1,j+1]+u[i,j+1])+1/2*u[i,j]

B[3,1] = 1/4*(u[i,j-1]+u[i+1,j-1])+1/2*u[i,j]
B[3,2] = 1/10*(u[i,j-1]+u[i+1,j-1]+u[i+1,j]+u[i+1,j+1]+u[i,j+1])+1/2*u[i,j]
B[3,3] = 1/4*(u[i+1,j+1]+u[i,j+1])+1/2*u[i,j]

B[4,1] = 1/6*(u[i+1,j-1]+u[i,j-1]+u[i+1,j])+1/2*u[i,j]
B[4,2] = 1/3*u[i+1,j]+2/3*u[i,j]
B[4,3] = 1/6*(u[i+1,j+1]+u[i+1,j]+u[i,j+1])+1/2*u[i,j]

X[(3*(i-2)+1):(3*(i-2)+3),(4*(j-2)+1):(4*(j-2)+4)]=B
}}
return(X)
}
